# 传统在线支付

商户系统->对接三方支付

## 微信支付

## 前置流程

1. 设置支付授权域名

## 支付流程

1. 小程序下单发起，发起支付
2. 商户系统生成订单
3. 请求支付系统下单
4. 支付系统生成预付单
5. 返回预付单订单号
6. 小程序用户发起支付->输入密码
7. 支付系统异步通知商户支付结果
8. 商户保留支付结果，并给支付系统返回成功接受处理。

* 由于网络问题，或者程序错误，通知可能在多次重复发送后丢失。
  解决方案，调用支付系统的订单查询功能，主动查询。或者定时任务对照补救。